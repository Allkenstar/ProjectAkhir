<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NovaPlay â€” Store</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
    body {
        background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%, #0f172a 100%);
        min-height: 100vh;
        padding-top: 80px;
    }

    .steam-card {
        background: #1e293b;
        border-radius: 14px;
        overflow: hidden;
        transition: .25s;
        box-shadow: 0 6px 12px rgba(0,0,0,0.2);
    }
    .steam-card:hover {
        transform: scale(1.05);
        box-shadow: 0 10px 18px rgba(0,0,0,0.4);
    }
    .steam-img {
        height: 180px;
        width: 100%;
        object-fit: cover;
    }

    /* Tambahan untuk placeholder Comment jadi putih */
    textarea::placeholder {
        color: white !important;
        opacity: 1;
    }
    textarea {
        color: white;
    }
</style>

</head>

<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
  <div class="container">
    <a class="navbar-brand" href="#">NovaPlay</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
            data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-between" id="navbarNav">

      <ul class="navbar-nav">
        <li class="nav-item"><a class="nav-link" href="home.html">Home</a></li>
        <li class="nav-item"><a class="nav-link active" href="store.html">Store</a></li>
        <li class="nav-item"><a class="nav-link" href="library.html">Library</a></li>
      </ul>

      <div class="d-flex align-items-center gap-3">
        <input type="text" placeholder="Search games..."
               class="form-control d-none d-sm-block bg-slate-700 text-white border-0"
               style="width: 250px;">
        <button class="btn btn-dark">ðŸ›’</button>
      </div>

    </div>
  </div>
</nav>



<!-- ============================= -->
<!--         MAIN STORE PAGE       -->
<!-- ============================= -->
<div class="max-w-7xl mx-auto px-4 py-8">

    <h2 class="text-3xl font-bold text-white mb-8">Featured Games</h2>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">

        <!-- GAME CARD TEMPLATE -->
        <!-- Kamu bisa duplikat jika ingin tambah game lain -->

        <!-- ====================== -->
        <!-- Game 1 : Cyberpunk 2077 -->
        <!-- ====================== -->
        <div class="steam-card p-0">

            <img src="https://cdn.akamai.steamstatic.com/steam/apps/1091500/header.jpg" class="steam-img">

            <div class="p-4">
                <h3 class="text-lg font-semibold text-white">Cyberpunk 2077</h3>
                <p class="text-blue-400 font-bold mt-1">$59.99</p>

                <button class="mt-3 w-full bg-blue-600 hover:bg-blue-700 text-white rounded-lg py-2">
                    Add to Cart
                </button>
            </div>

            <!-- REVIEW BOX -->
            <div class="mt-4 p-4 bg-slate-900 rounded-xl mx-4 mb-4">
                
                <!-- â­ RATING -->
                <div class="flex text-yellow-400 text-xl cursor-pointer rating"
                    data-game="Cyberpunk 2077">
                    â˜…â˜…â˜…â˜…â˜…
                </div>

                <!-- COMMENT INPUT -->
                <textarea class="form-control bg-slate-700 text-white mt-3 comment-input"
                          placeholder="Write your review..."></textarea>

                <!-- SUBMIT -->
                <button class="mt-3 w-full bg-green-600 hover:bg-green-700 text-white rounded-lg py-2 submit-review"
                        data-game="Cyberpunk 2077">
                    Submit Review
                </button>

                <!-- REVIEWS -->
                <div class="mt-4 text-white review-list" data-game="Cyberpunk 2077">
                    <h4 class="text-lg font-semibold mb-2">Reviews</h4>
                    <div class="reviews-container space-y-3"></div>
                </div>

            </div>

        </div>



        <!-- ====================== -->
        <!-- Game 2 : Red Dead 2 -->
        <!-- ====================== -->
        <div class="steam-card p-0">

            <img src="https://cdn.akamai.steamstatic.com/steam/apps/1174180/header.jpg" class="steam-img">

            <div class="p-4">
                <h3 class="text-lg font-semibold text-white">Red Dead Redemption 2</h3>
                <p class="text-blue-400 font-bold mt-1">$59.99</p>

                <button class="mt-3 w-full bg-blue-600 hover:bg-blue-700 text-white rounded-lg py-2">
                    Add to Cart
                </button>
            </div>

            <!-- REVIEW BOX COPY -->
            <div class="mt-4 p-4 bg-slate-900 rounded-xl mx-4 mb-4">

                <div class="flex text-yellow-400 text-xl cursor-pointer rating"
                    data-game="Red Dead Redemption 2">
                    â˜…â˜…â˜…â˜…â˜…
                </div>

                <textarea class="form-control bg-slate-700 text-white mt-3 comment-input"
                          placeholder="Write your review..."></textarea>

                <button class="mt-3 w-full bg-green-600 hover:bg-green-700 text-white rounded-lg py-2 submit-review"
                        data-game="Red Dead Redemption 2">
                    Submit Review
                </button>

                <div class="mt-4 text-white review-list" data-game="Red Dead Redemption 2">
                    <h4 class="text-lg font-semibold mb-2">Reviews</h4>
                    <div class="reviews-container space-y-3"></div>
                </div>

            </div>

        </div>


    </div> <!-- end grid -->

</div> <!-- end main -->






<!-- ======================================== -->
<!-- JAVASCRIPT REVIEW SYSTEM (AJAX + RATING) -->
<!-- ======================================== -->
<script>
// =========================
// INIT RATING STAR
// =========================
document.querySelectorAll(".rating").forEach(ratingBox => {
    ratingBox.innerHTML = "";
    for (let i = 1; i <= 5; i++) {
        let star = document.createElement("span");
        star.innerHTML = "â˜…";
        star.dataset.value = i;

        star.addEventListener("click", () => {
            ratingBox.dataset.selected = i;
            updateStars(ratingBox);
        });

        ratingBox.appendChild(star);
    }
});

function updateStars(box) {
    let selected = box.dataset.selected || 0;
    box.querySelectorAll("span").forEach(star => {
        star.style.color = (star.dataset.value <= selected) ? "#FFD700" : "#444";
    });
}



// =========================
// SUBMIT REVIEW AJAX
// =========================
document.querySelectorAll(".submit-review").forEach(btn => {
    btn.addEventListener("click", () => {
        let game = btn.dataset.game;
        let rating = btn.parentElement.querySelector(".rating").dataset.selected || 0;
        let comment = btn.parentElement.querySelector(".comment-input").value.trim();

        if (rating == 0) return alert("Please select rating!");
        if (comment === "") return alert("Please write a comment!");

        fetch("api/review.php", {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: `game=${game}&rating=${rating}&comment=${comment}`
        })
        .then(res => res.text())
        .then(response => {
            alert("Review added!");
            btn.parentElement.querySelector(".comment-input").value = "";
            loadReviews(game);
        });
    });
});


// =========================
// LOAD REVIEWS
// =========================
function loadReviews(gameName) {
    fetch("api/get_reviews.php?game=" + encodeURIComponent(gameName))
    .then(res => res.json())
    .then(data => {
        document.querySelectorAll(".review-list").forEach(box => {
            if (box.dataset.game !== gameName) return;

            let container = box.querySelector(".reviews-container");
            container.innerHTML = "";

            data.forEach(item => {
                container.innerHTML += `
                    <div class="bg-slate-800 p-3 rounded-lg">
                        <div class="text-yellow-400">Rating: ${"â˜…".repeat(item.rating)}</div>
                        <div class="text-gray-200 mt-1">${item.comment}</div>
                        <div class="text-gray-500 text-sm">${item.created_at}</div>
                    </div>
                `;
            });
        });
    });
}

document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".review-list").forEach(section => {
        loadReviews(section.dataset.game);
    });
});
</script>



</body>
</html>
